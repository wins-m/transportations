<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>äº¤é€šè½¨è¿¹çƒ­åŠ›å›¾</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <style>
        body {
            margin: 0;
        }

        #map {
            height: 100vh;
            width: 100vw;
        }

        .legend {
            padding: 10px;
            background: white;
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
        }

        .route-count {
            font-weight: bold;
            color: #ff0000;
        }
    </style>
</head>

<body>
    <div id="map"></div>
    <script>
        // åˆå§‹åŒ–åœ°å›¾
        const map = L.map('map').setView([30, 110], 5);
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 18,
            attribution: '&copy; OpenStreetMap'
        }).addTo(map);

        // åŸå¸‚åæ ‡æ•°æ®
        const cityCoords = {
            "å®æ³¢ç«™": [
                29.8629414928399,
                121.53739804767
            ],
            "æ­å·ä¸œç«™": [
                30.2925,
                120.2119
            ],
            "æ·±åœ³å®å®‰T3": [
                22.627554,
                113.81184
            ],
            "æ­å·è§å±±T4": [
                30.234134,
                120.430634
            ],
            "é¦™æ¸¯è¥¿ä¹é¾™ç«™": [
                22.3047,
                114.1614
            ],
            "ä¸Šæµ·è™¹æ¡¥ç«™": [
                31.1945,
                121.3188
            ],
            "è´µé˜³é¾™æ´å ¡T3": [
                26.5385,
                106.8007
            ],
            "æ–°åŠ å¡æ¨Ÿå®œT1": [
                1.3594,
                103.9895
            ],
            "Melaka Sentral": [
                2.220788,
                102.249576
            ],
            "æ–°åŠ å¡": [
                1.3521,
                103.8198
            ],
            "KL Sentral": [
                3.134553,
                101.686163
            ],
            "Ipoh Station": [
                4.59748,
                101.073073
            ],
            "KL Sentral Station": [
                3.134553,
                101.686163
            ],
            "Butterworth Station": [
                5.393295,
                100.366588
            ],
            "Padang Besar (Thailand) Station": [
                6.668834,
                100.324502
            ],
            "Krung Thep Aphiwat Station": [
                13.803965,
                100.54192
            ],
            "Chiang Mai Station": [
                18.783987982107366,
                99.01697066090912
            ],
            "Chiang Rai BT1": [
                19.904645345183543,
                99.83419860546132
            ],
            "Chiang Mai BT3": [
                18.799906188457545,
                99.01778681437301
            ],
            "Chiang Khong Custom": [
                20.21539986406964,
                100.43528298856795
            ],
            "Luang Prabang Slow Boat Terminal": [
                19.924889693412215,
                102.18046162648591
            ],
            "Houayxay Slow Boat Pier": [
                20.285056907520673,
                100.40726694337108
            ],
            "è¥¿åŒç‰ˆçº³ç«™": [
                21.9737,
                100.7656
            ],
            "Luang Prabang Station": [
                19.867496,
                102.21401
            ],
            "æ­å·è§å±±T3": [
                30.238782,
                120.435702
            ],
            "å˜æ´’": [
                21.972406,
                100.764783
            ],
            "åŒ—äº¬å—ç«™": [
                39.865,
                116.3785
            ],
            "æ­å·è¥¿ç«™": [
                30.2966,
                119.9989
            ],
            "å¤§å…´": [
                39.510561,
                116.429172
            ],
            "å¹¿å·ç™½äº‘T1": [
                23.386628,
                113.30307
            ],
            "æ­å·å—ç«™": [
                30.172196379350876,
                120.29337945538573
            ],
            "å¹¿å·ç«™": [
                23.1482,
                113.2644
            ],
            "å¾å·ä¸œç«™": [
                34.2694,
                117.2064
            ],
            "åŒ—äº¬ç«™": [
                39.9024,
                116.4274
            ],
            "ä¸Šæµ·ç«™": [
                31.249574,
                121.455708
            ],
            "å—äº¬å—ç«™": [
                31.9744,
                118.804
            ],
            "å¤§åŒå—ç«™": [
                40.0394,
                113.3
            ],
            "åŒ—äº¬åŒ—ç«™": [
                39.9425,
                116.3536
            ],
            "é’å²›åŒ—ç«™": [
                36.1694,
                120.3824
            ],
            "é’å²›ç«™": [
                36.0671,
                120.3826
            ],
            "æ ç¤¾": [
                29.821287,
                121.466363
            ],
            "é‡‘åç«™": [
                29.079,
                119.6474
            ],
            "é•¿æ²™å—ç«™": [
                28.1469,
                113.0645
            ],
            "æ˜†æ˜å—ç«™": [
                24.88,
                102.833
            ],
            "è´µé˜³åŒ—ç«™": [
                26.6512,
                106.6306
            ],
            "é‡åº†è¥¿ç«™": [
                29.5029,
                106.4335
            ],
            "æˆéƒ½ä¸œç«™": [
                30.628779,
                104.140947
            ],
            "æ²™åªåç«™": [
                29.541,
                106.456
            ],
            "å®æ³¢æ ç¤¾T2": [
                29.820289,
                121.46108
            ],
            "æˆéƒ½åŒæµT1": [
                30.579524,
                103.956727
            ],
            "ä¸Šæµ·æµ¦ä¸œT2": [
                31.151069,
                121.809431
            ],
            "åŒ—äº¬é¦–éƒ½T3": [
                40.065329,
                116.613638
            ],
            "ä¹Œé²æœ¨é½åœ°çªå ¡T2": [
                43.902179,
                87.472381
            ],
            "åŒ—äº¬é¦–éƒ½T2": [
                40.079904,
                116.594548
            ],
            "å–€ä»€å¾•å®": [
                39.541179,
                76.024433
            ],
            "æˆéƒ½åŒæµT2": [
                30.569798,
                103.955194
            ],
            "æ‹‰è¨è´¡å˜T2": [
                29.29048,
                90.899976
            ],
            "æ—¥å–€åˆ™ç«™": [
                29.2675,
                88.8823
            ],
            "æ‹‰è¨ç«™": [
                29.6259,
                91.1384
            ],
            "æ¡ä¹¡ç«™": [
                30.63,
                120.54
            ],
            "å¤©æ´¥ç«™": [
                39.1367,
                117.2056
            ],
            "æ­å·è§å±±T1": [
                30.234134,
                120.430634
            ],
            "ä¸Šæµ·å—ç«™": [
                31.1547,
                121.4298
            ],
            "å¤§è¿åŒ—ç«™": [
                39.0151,
                121.5389
            ],
            "èˆ’å…°": [
                44.405922,
                126.965515
            ],
            "å¤§è¿": [
                38.913962,
                121.614786
            ],
            "å‰æ—ç«™": [
                43.8379,
                126.5496
            ],
            "èˆ’å…°ç«™": [
                44.4071,
                126.9476
            ],
            "é•¿æ˜¥ç«™": [
                43.9054,
                125.3255
            ],
            "ç™½åŸç«™": [
                45.6196,
                122.8387
            ],
            "å‘¼ä¼¦è´å°”": [
                49.166536,
                119.77845
            ],
            "ç™½åŸ": [
                45.620131,
                122.838102
            ],
            "æµ·æ‹‰å°”ç«™": [
                49.2116,
                119.7666
            ]
        };

        // æ¨¡æ‹Ÿè¡Œç¨‹æ•°æ®ï¼ˆå«é‡å¤è·¯çº¿ï¼‰
        const travelSegments = [
            {
                "type": "Railway",
                "date": "2025-04-02",
                "from": "å®æ³¢ç«™",
                "to": "æ­å·ä¸œç«™",
                "vehicle": "D3146",
                "duration": "01:04:00",
                "distance": "1438 km",
                "seat": "07è½¦05A",
                "price": 57,
                "note": "ç§¯åˆ†å…‘æ¢"
            },
            {
                "type": "Airline",
                "date": "2025-02-23",
                "from": "æ·±åœ³å®å®‰T3",
                "to": "æ­å·è§å±±T4",
                "vehicle": "CA1734",
                "duration": "01:36:00",
                "distance": "1179 km",
                "seat": "21A",
                "price": 490,
                "note": "é¦™æ¸¯è¡Œè¿”ç¨‹"
            },
            {
                "type": "Railway",
                "date": "2025-02-21",
                "from": "æ­å·ä¸œç«™",
                "to": "é¦™æ¸¯è¥¿ä¹é¾™ç«™",
                "vehicle": "G899",
                "duration": "10:09:00",
                "distance": "1662 km",
                "seat": "09è½¦032å·ä¸Šé“º",
                "price": 770,
                "note": "é¦™æ¸¯è¡Œå»ç¨‹"
            },
            {
                "type": "Railway",
                "date": "2024-12-01",
                "from": "ä¸Šæµ·è™¹æ¡¥ç«™",
                "to": "æ­å·ä¸œç«™",
                "vehicle": "D3101",
                "duration": "01:10:00",
                "distance": "891 km",
                "seat": "07è½¦11C",
                "price": 59,
                "note": "ç§¯åˆ†å…‘æ¢+ç§¯åˆ†æ”¹ç­¾"
            },
            {
                "type": "Railway",
                "date": "2024-11-29",
                "from": "æ­å·ä¸œç«™",
                "to": "ä¸Šæµ·è™¹æ¡¥ç«™",
                "vehicle": "G9508",
                "duration": "00:56:00",
                "distance": "159 km",
                "seat": "08è½¦08F",
                "price": 80,
                "note": "åŠé€šè¡Œè¯"
            },
            {
                "type": "Railway",
                "date": "2024-11-10",
                "from": "ä¸Šæµ·è™¹æ¡¥ç«™",
                "to": "æ­å·ä¸œç«™",
                "vehicle": "D3101",
                "duration": "01:10:00",
                "distance": "891 km",
                "seat": "05è½¦10C",
                "price": 59,
                "note": NaN
            },
            {
                "type": "Railway",
                "date": "2024-11-09",
                "from": "ä¸Šæµ·è™¹æ¡¥ç«™",
                "to": "æ­å·ä¸œç«™",
                "vehicle": "D2125",
                "duration": "00:56:00",
                "distance": "1084 km",
                "seat": "10è½¦17F",
                "price": 9,
                "note": "æ”¹ç­¾è´¹"
            },
            {
                "type": "Railway",
                "date": "2024-11-09",
                "from": "æ­å·ä¸œç«™",
                "to": "ä¸Šæµ·è™¹æ¡¥ç«™",
                "vehicle": "G7580",
                "duration": "01:00:00",
                "distance": "780 km",
                "seat": "02è½¦10D",
                "price": 73,
                "note": "è½æˆ·2ï¼Œç§¯åˆ†å…‘æ¢"
            },
            {
                "type": "Railway",
                "date": "2024-10-26",
                "from": "ä¸Šæµ·è™¹æ¡¥ç«™",
                "to": "æ­å·ä¸œç«™",
                "vehicle": "D2125",
                "duration": "00:56:00",
                "distance": "1084 km",
                "seat": "05è½¦05C",
                "price": 59,
                "note": NaN
            },
            {
                "type": "Railway",
                "date": "2024-10-25",
                "from": "æ­å·ä¸œç«™",
                "to": "ä¸Šæµ·è™¹æ¡¥ç«™",
                "vehicle": "G9508",
                "duration": "00:56:00",
                "distance": "159 km",
                "seat": "13è½¦12D",
                "price": 80,
                "note": "è½æˆ·1"
            },
            {
                "type": "Airline",
                "date": "2024-08-04",
                "from": "è´µé˜³é¾™æ´å ¡T3",
                "to": "æ­å·è§å±±T4",
                "vehicle": "CZ2190",
                "duration": "02:04:00",
                "distance": "1538 km",
                "seat": "38K",
                "price": 1330,
                "note": NaN
            },
            {
                "type": "Airline",
                "date": "2024-08-01",
                "from": "æ­å·è§å±±T4",
                "to": "è´µé˜³é¾™æ´å ¡T3",
                "vehicle": "CA1749",
                "duration": "02:02:00",
                "distance": "1538 km",
                "seat": "23A",
                "price": 1510,
                "note": NaN
            },
            {
                "type": "Airline",
                "date": "2024-07-08",
                "from": "æ–°åŠ å¡æ¨Ÿå®œT1",
                "to": "æ­å·è§å±±T4",
                "vehicle": "TR188",
                "duration": "04:54:00",
                "distance": "3649 km",
                "seat": "28J",
                "price": 1043,
                "note": NaN
            },
            {
                "type": "Other",
                "date": "2024-07-06",
                "from": "Melaka Sentral",
                "to": "æ–°åŠ å¡",
                "vehicle": "VV85",
                "duration": "04:30:00",
                "distance": "nan km",
                "seat": NaN,
                "price": NaN,
                "note": NaN
            },
            {
                "type": "Other",
                "date": "2024-07-03",
                "from": "KL Sentral",
                "to": "Melaka Sentral",
                "vehicle": "4723175",
                "duration": "02:00:00",
                "distance": "nan km",
                "seat": "03",
                "price": "RM 14.4",
                "note": NaN
            },
            {
                "type": "Railway",
                "date": "2024-07-01",
                "from": "Ipoh Station",
                "to": "KL Sentral Station",
                "vehicle": "EP9277",
                "duration": "02:34:00",
                "distance": "nan km",
                "seat": NaN,
                "price": NaN,
                "note": NaN
            },
            {
                "type": "Railway",
                "date": "2024-07-01",
                "from": "Butterworth Station",
                "to": "Ipoh Station",
                "vehicle": "2907",
                "duration": "01:56:00",
                "distance": "nan km",
                "seat": NaN,
                "price": NaN,
                "note": NaN
            },
            {
                "type": "Railway",
                "date": "2024-06-28",
                "from": "Padang Besar (Thailand) Station",
                "to": "Butterworth Station",
                "vehicle": "-",
                "duration": "03:00:00",
                "distance": "nan km",
                "seat": NaN,
                "price": "RM 11.4",
                "note": NaN
            },
            {
                "type": "Railway",
                "date": "2024-06-27",
                "from": "Krung Thep Aphiwat Station",
                "to": "Padang Besar (Thailand) Station",
                "vehicle": "Train No. 45",
                "duration": "15:49:00",
                "distance": "nan km",
                "seat": NaN,
                "price": NaN,
                "note": NaN
            },
            {
                "type": "Railway",
                "date": "2024-06-23",
                "from": "Chiang Mai Station",
                "to": "Krung Thep Aphiwat Station",
                "vehicle": "Train No. 10",
                "duration": "12:50:00",
                "distance": "nan km",
                "seat": "6è½¦29å·ä¸Š",
                "price": 188,
                "note": NaN
            },
            {
                "type": "Other",
                "date": "2024-06-20",
                "from": "Chiang Rai BT1",
                "to": "Chiang Mai BT3",
                "vehicle": "209",
                "duration": "03:20:00",
                "distance": "182 km",
                "seat": "4B",
                "price": 61,
                "note": NaN
            },
            {
                "type": "Other",
                "date": "2024-06-19",
                "from": "Chiang Khong Custom",
                "to": "Chiang Rai BT1",
                "vehicle": "-",
                "duration": "02:00:00",
                "distance": "103 km",
                "seat": NaN,
                "price": NaN,
                "note": "å’Œä¸€ç¾¤ç™½äººåŒ…è½¦"
            },
            {
                "type": "Other",
                "date": "2024-06-18",
                "from": "Luang Prabang Slow Boat Terminal",
                "to": "Houayxay Slow Boat Pier",
                "vehicle": "0112",
                "duration": "33:30:00",
                "distance": "- km",
                "seat": "-",
                "price": 122,
                "note": "ç»åœ Pak Bang è¿‡å¤œ"
            },
            {
                "type": "Railway",
                "date": "2024-06-15",
                "from": "è¥¿åŒç‰ˆçº³ç«™",
                "to": "Luang Prabang Station",
                "vehicle": "D85",
                "duration": "05:02:00",
                "distance": "316 km",
                "seat": "07è½¦07F",
                "price": 174,
                "note": NaN
            },
            {
                "type": "Airline",
                "date": "2024-06-10",
                "from": "æ­å·è§å±±T3",
                "to": "å˜æ´’",
                "vehicle": "GJ8823",
                "duration": "04:35:00",
                "distance": "2310 km",
                "seat": "8A",
                "price": 400,
                "note": "ç»åœæ¯•èŠ‚é£é›„"
            },
            {
                "type": "Railway",
                "date": "2024-05-27",
                "from": "åŒ—äº¬å—ç«™",
                "to": "æ­å·ä¸œç«™",
                "vehicle": "G187",
                "duration": "06:04:00",
                "distance": "1586 km",
                "seat": "13è½¦04F",
                "price": 623,
                "note": "ç­”è¾©è¿”ç¨‹"
            },
            {
                "type": "Railway",
                "date": "2024-05-26",
                "from": "åŒ—äº¬å—ç«™",
                "to": "æ­å·è¥¿ç«™",
                "vehicle": "G37",
                "duration": "04:48:00",
                "distance": "1416 km",
                "seat": "07è½¦10A",
                "price": 10,
                "note": "é€€ç¥¨è´¹"
            },
            {
                "type": "Railway",
                "date": "2024-05-26",
                "from": "åŒ—äº¬å—ç«™",
                "to": "æ­å·è¥¿ç«™",
                "vehicle": "G37",
                "duration": "04:48:00",
                "distance": "1416 km",
                "seat": "07è½¦10A",
                "price": 93.5,
                "note": "æ”¹ç­¾è´¹"
            },
            {
                "type": "Airline",
                "date": "2024-05-22",
                "from": "æ­å·è§å±±T3",
                "to": "å¤§å…´",
                "vehicle": "KN2332",
                "duration": "01:51:00",
                "distance": "1200 km",
                "seat": "34A",
                "price": 460,
                "note": "24æ˜¥ç­”è¾©"
            },
            {
                "type": "Railway",
                "date": "2024-02-19",
                "from": "åŒ—äº¬å—ç«™",
                "to": "æ­å·ä¸œç«™",
                "vehicle": "G39",
                "duration": "04:18:00",
                "distance": "1279 km",
                "seat": "13è½¦03C",
                "price": 506,
                "note": "24æ˜¥å®ä¹ "
            },
            {
                "type": "Railway",
                "date": "2024-02-18",
                "from": "æ­å·ä¸œç«™",
                "to": "åŒ—äº¬å—ç«™",
                "vehicle": "G192",
                "duration": "05:45:00",
                "distance": "1279 km",
                "seat": "07è½¦05A",
                "price": 506,
                "note": "24æ˜¥æ³¨å†Œ"
            },
            {
                "type": "Airline",
                "date": "2023-12-11",
                "from": "å¹¿å·ç™½äº‘T1",
                "to": "æ­å·è§å±±T3",
                "vehicle": "HU7161",
                "duration": "01:42:00",
                "distance": "1099 km",
                "seat": "43A",
                "price": 536,
                "note": "å¹¿é©¬è¿”ç¨‹"
            },
            {
                "type": "Railway",
                "date": "2023-12-08",
                "from": "æ­å·å—ç«™",
                "to": "å¹¿å·ç«™",
                "vehicle": "T169",
                "duration": "-9:16:00",
                "distance": "1598 km",
                "seat": "06è½¦005å·ä¸Šé“º",
                "price": 296.5,
                "note": "å¹¿å·é©¬æ‹‰æ¾"
            },
            {
                "type": "Railway",
                "date": "2023-11-22",
                "from": "åŒ—äº¬å—ç«™",
                "to": "æ­å·ä¸œç«™",
                "vehicle": "G185",
                "duration": "05:56:00",
                "distance": "1506 km",
                "seat": "04è½¦05F",
                "price": 506,
                "note": "23ç§‹å®ä¹ "
            },
            {
                "type": "Railway",
                "date": "2023-11-06",
                "from": "å¾å·ä¸œç«™",
                "to": "åŒ—äº¬å—ç«™",
                "vehicle": "G110",
                "duration": "03:01:00",
                "distance": "1318 km",
                "seat": "11è½¦14D",
                "price": 322,
                "note": "å¾é©¬è¿”ç¨‹ï¼ŒG14æ”¹ç­¾"
            },
            {
                "type": "Railway",
                "date": "2023-11-04",
                "from": "åŒ—äº¬å—ç«™",
                "to": "å¾å·ä¸œç«™",
                "vehicle": "G37",
                "duration": "02:21:00",
                "distance": "1416 km",
                "seat": "04è½¦15A",
                "price": 350,
                "note": "å¾å·é©¬æ‹‰æ¾"
            },
            {
                "type": "Railway",
                "date": "2023-10-08",
                "from": "å®æ³¢ç«™",
                "to": "åŒ—äº¬å—ç«™",
                "vehicle": "G182",
                "duration": "06:38:00",
                "distance": "1434 km",
                "seat": "14è½¦18A",
                "price": 559,
                "note": "23å›½åº†è¿”æ ¡"
            },
            {
                "type": "Railway",
                "date": "2023-09-30",
                "from": "åŒ—äº¬ç«™",
                "to": "ä¸Šæµ·ç«™",
                "vehicle": "1461",
                "duration": "18:49:00",
                "distance": "1463 km",
                "seat": "07è½¦08ä¸‹",
                "price": 226.5,
                "note": "23å›½åº†è¿”ä¹¡"
            },
            {
                "type": "Railway",
                "date": "2023-09-10",
                "from": "ä¸Šæµ·ç«™",
                "to": "åŒ—äº¬ç«™",
                "vehicle": "T110",
                "duration": "16:02:00",
                "distance": "1463 km",
                "seat": "05è½¦14ä¸Š",
                "price": 476.5,
                "note": "23ç§‹è¿”æ ¡ï¼Œæ”¹ç­¾10è½¦12ä¸Šï¼Œæ¢"
            },
            {
                "type": "Railway",
                "date": "2023-08-14",
                "from": "å—äº¬å—ç«™",
                "to": "ä¸Šæµ·è™¹æ¡¥ç«™",
                "vehicle": "G117",
                "duration": "01:09:00",
                "distance": "1318 km",
                "seat": "11è½¦13D",
                "price": 153,
                "note": "23å¤å®ä¹ ï¼Œç§¯åˆ†å…‘æ¢"
            },
            {
                "type": "Railway",
                "date": "2023-08-14",
                "from": "åŒ—äº¬å—ç«™",
                "to": "å—äº¬å—ç«™",
                "vehicle": "G117",
                "duration": "04:24:00",
                "distance": "1318 km",
                "seat": "12è½¦07A",
                "price": 400,
                "note": "23å¤å®ä¹ "
            },
            {
                "type": "Railway",
                "date": "2023-08-05",
                "from": "å®æ³¢ç«™",
                "to": "åŒ—äº¬å—ç«™",
                "vehicle": "G36",
                "duration": "05:23:00",
                "distance": "1434 km",
                "seat": "06è½¦07A",
                "price": 559,
                "note": "23å¤å®ä¹ "
            },
            {
                "type": "Railway",
                "date": "2023-07-23",
                "from": "ä¸Šæµ·è™¹æ¡¥ç«™",
                "to": "å®æ³¢ç«™",
                "vehicle": "D3141",
                "duration": "02:07:00",
                "distance": "1549 km",
                "seat": "07è½¦16C",
                "price": 116,
                "note": "23å¤è¿”ä¹¡"
            },
            {
                "type": "Railway",
                "date": "2023-06-11",
                "from": "åŒ—äº¬å—ç«™",
                "to": "ä¸Šæµ·è™¹æ¡¥ç«™",
                "vehicle": "G11",
                "duration": "04:38:00",
                "distance": "1318 km",
                "seat": "10è½¦06F",
                "price": 662,
                "note": "23å¤å®ä¹ "
            },
            {
                "type": "Railway",
                "date": "2023-04-29",
                "from": "å¤§åŒå—ç«™",
                "to": "åŒ—äº¬åŒ—ç«™",
                "vehicle": "G2540",
                "duration": "01:45:00",
                "distance": "338 km",
                "seat": "11è½¦05F",
                "price": 156,
                "note": "å¤§åŒè¡Œè¿”ç¨‹"
            },
            {
                "type": "Railway",
                "date": "2023-04-28",
                "from": "åŒ—äº¬åŒ—ç«™",
                "to": "å¤§åŒå—ç«™",
                "vehicle": "G2533",
                "duration": "02:13:00",
                "distance": "338 km",
                "seat": "04è½¦02D",
                "price": 170,
                "note": "å¤§åŒè¡Œ"
            },
            {
                "type": "Railway",
                "date": "2023-03-19",
                "from": "é’å²›åŒ—ç«™",
                "to": "åŒ—äº¬å—ç«™",
                "vehicle": "G212",
                "duration": "03:23:00",
                "distance": "804 km",
                "seat": "14è½¦04F",
                "price": 336,
                "note": "é’å²›åŠé©¬è¿”ç¨‹"
            },
            {
                "type": "Railway",
                "date": "2023-03-18",
                "from": "åŒ—äº¬å—ç«™",
                "to": "é’å²›ç«™",
                "vehicle": "G205",
                "duration": "03:49:00",
                "distance": "819 km",
                "seat": "03è½¦07F",
                "price": 349,
                "note": "é’å²›åŠé©¬"
            },
            {
                "type": "Railway",
                "date": "2023-02-07",
                "from": "å®æ³¢ç«™",
                "to": "åŒ—äº¬å—ç«™",
                "vehicle": "G36",
                "duration": "05:23:00",
                "distance": "1434 km",
                "seat": "07è½¦16A",
                "price": 541,
                "note": "23æ˜¥è¿”æ ¡"
            },
            {
                "type": "Airline",
                "date": "2023-01-18",
                "from": "å¤§å…´",
                "to": "æ ç¤¾",
                "vehicle": "MU6488",
                "duration": "02:09:00",
                "distance": "1338 km",
                "seat": "47A",
                "price": 362,
                "note": "22å†¬è¿”ä¹¡"
            },
            {
                "type": "Railway",
                "date": "2022-08-23",
                "from": "å®æ³¢ç«™",
                "to": "åŒ—äº¬å—ç«™",
                "vehicle": "G182",
                "duration": "06:38:00",
                "distance": "1434 km",
                "seat": "06è½¦12A",
                "price": 541,
                "note": "22ç§‹å…¥å­¦"
            },
            {
                "type": "Railway",
                "date": "2022-07-29",
                "from": "é‡‘åç«™",
                "to": "å®æ³¢ç«™",
                "vehicle": "G2334",
                "duration": "02:25:00",
                "distance": "1857 km",
                "seat": "02è½¦01C",
                "price": 130.5,
                "note": "å®æ³¢æš‚é©»"
            },
            {
                "type": "Railway",
                "date": "2022-07-28",
                "from": "é•¿æ²™å—ç«™",
                "to": "é‡‘åç«™",
                "vehicle": "G1350",
                "duration": "03:25:00",
                "distance": "1083 km",
                "seat": "07è½¦09A",
                "price": 338,
                "note": "é‡‘åèšä¼š"
            },
            {
                "type": "Railway",
                "date": "2022-07-27",
                "from": "æ˜†æ˜å—ç«™",
                "to": "é•¿æ²™å—ç«™",
                "vehicle": "G1696",
                "duration": "06:15:00",
                "distance": "2092 km",
                "seat": "10è½¦12A",
                "price": 498.5,
                "note": "é•¿æ²™è¡Œ"
            },
            {
                "type": "Railway",
                "date": "2022-07-25",
                "from": "è´µé˜³åŒ—ç«™",
                "to": "æ˜†æ˜å—ç«™",
                "vehicle": "G2803",
                "duration": "02:04:00",
                "distance": "nan km",
                "seat": "04è½¦13F",
                "price": 212.5,
                "note": "æ˜†æ˜è¡Œ"
            },
            {
                "type": "Railway",
                "date": "2022-07-23",
                "from": "é‡åº†è¥¿ç«™",
                "to": "è´µé˜³åŒ—ç«™",
                "vehicle": "C6033",
                "duration": "02:13:00",
                "distance": "nan km",
                "seat": "10è½¦02F",
                "price": 139,
                "note": "è´µé˜³è¡Œ"
            },
            {
                "type": "Railway",
                "date": "2022-07-21",
                "from": "æˆéƒ½ä¸œç«™",
                "to": "æ²™åªåç«™",
                "vehicle": "G8615",
                "duration": "01:18:00",
                "distance": "299 km",
                "seat": "06è½¦02A",
                "price": 164,
                "note": "é‡åº†è¡Œ"
            },
            {
                "type": "Airline",
                "date": "2022-07-09",
                "from": "å®æ³¢æ ç¤¾T2",
                "to": "æˆéƒ½åŒæµT1",
                "vehicle": "3U8938",
                "duration": "02:26:00",
                "distance": "1803 km",
                "seat": "41A",
                "price": 920,
                "note": "å·è¥¿è¡Œ"
            },
            {
                "type": "Railway",
                "date": "2022-07-02",
                "from": "åŒ—äº¬å—ç«™",
                "to": "å®æ³¢ç«™",
                "vehicle": "G35",
                "duration": "05:18:00",
                "distance": "1434 km",
                "seat": "12è½¦01F",
                "price": 541,
                "note": "22å¤è¿”ä¹¡"
            },
            {
                "type": "Airline",
                "date": "2022-02-06",
                "from": "ä¸Šæµ·æµ¦ä¸œT2",
                "to": "å¤§å…´",
                "vehicle": "CZ8882",
                "duration": "01:51:00",
                "distance": "1178 km",
                "seat": "50A",
                "price": 380,
                "note": "22æ˜¥è¿”æ ¡"
            },
            {
                "type": "Airline",
                "date": "2022-01-29",
                "from": "åŒ—äº¬é¦–éƒ½T3",
                "to": "å®æ³¢æ ç¤¾T2",
                "vehicle": "CA1839",
                "duration": "01:58:00",
                "distance": "1338 km",
                "seat": "16L",
                "price": 470,
                "note": "22å†¬è¿”ä¹¡"
            },
            {
                "type": "Airline",
                "date": "2021-07-12",
                "from": "ä¹Œé²æœ¨é½åœ°çªå ¡T2",
                "to": "åŒ—äº¬é¦–éƒ½T2",
                "vehicle": "HU7146",
                "duration": "03:14:00",
                "distance": "2842 km",
                "seat": "57A",
                "price": 860,
                "note": "å–€ä»€è¡Œï¼Œè¿”ç¨‹"
            },
            {
                "type": "Airline",
                "date": "2021-07-10",
                "from": "å–€ä»€å¾•å®",
                "to": "ä¹Œé²æœ¨é½åœ°çªå ¡T2",
                "vehicle": "CA1478",
                "duration": "01:47:00",
                "distance": "1311 km",
                "seat": "15A",
                "price": 420,
                "note": "ä¹Œé²æœ¨é½æš‚é©»"
            },
            {
                "type": "Airline",
                "date": "2021-07-05",
                "from": "åŒ—äº¬é¦–éƒ½T3",
                "to": "å–€ä»€å¾•å®",
                "vehicle": "CA1477",
                "duration": "06:49:00",
                "distance": "3752 km",
                "seat": "30L",
                "price": 1740,
                "note": "å–€ä»€è¡Œ"
            },
            {
                "type": "Railway",
                "date": "2021-06-29",
                "from": "å®æ³¢ç«™",
                "to": "åŒ—äº¬å—ç«™",
                "vehicle": "G182",
                "duration": "06:38:00",
                "distance": "1434 km",
                "seat": "11è½¦18F",
                "price": 541,
                "note": "21å¤è¿”æ ¡"
            },
            {
                "type": "Railway",
                "date": "2021-06-17",
                "from": "åŒ—äº¬å—ç«™",
                "to": "ä¸Šæµ·è™¹æ¡¥ç«™",
                "vehicle": "G145",
                "duration": "05:58:00",
                "distance": "1318 km",
                "seat": "15è½¦09F",
                "price": 526,
                "note": "é«˜é‡‘é¢è¯•"
            },
            {
                "type": "Railway",
                "date": "2021-03-06",
                "from": "å®æ³¢ç«™",
                "to": "åŒ—äº¬å—ç«™",
                "vehicle": NaN,
                "duration": "",
                "distance": "1434 km",
                "seat": NaN,
                "price": NaN,
                "note": "21æ˜¥è¿”æ ¡ï¼Œè½¦ç¥¨æŠ¥é”€"
            },
            {
                "type": "Airline",
                "date": "2021-02-04",
                "from": "åŒ—äº¬é¦–éƒ½T2",
                "to": "å®æ³¢æ ç¤¾T2",
                "vehicle": "MU5178",
                "duration": "02:02:00",
                "distance": "1338 km",
                "seat": "48L",
                "price": 370,
                "note": "21æ˜¥è¿”ä¹¡"
            },
            {
                "type": "Railway",
                "date": "2020-09-13",
                "from": "å®æ³¢ç«™",
                "to": "åŒ—äº¬å—ç«™",
                "vehicle": "G274",
                "duration": "06:42:00",
                "distance": "1434 km",
                "seat": "12è½¦01F",
                "price": 446.5,
                "note": "20ç§‹è¿”æ ¡"
            },
            {
                "type": "Airline",
                "date": "2020-09-06",
                "from": "æˆéƒ½åŒæµT2",
                "to": "å®æ³¢æ ç¤¾T2",
                "vehicle": "9C6163",
                "duration": "02:55:00",
                "distance": "nan km",
                "seat": NaN,
                "price": 560,
                "note": "å·è—è¡Œè¿”ç¨‹"
            },
            {
                "type": "Airline",
                "date": "2020-09-03",
                "from": "æ‹‰è¨è´¡å˜T2",
                "to": "æˆéƒ½åŒæµT2",
                "vehicle": "EU2744",
                "duration": "01:56:00",
                "distance": "1334 km",
                "seat": "8F",
                "price": 1020,
                "note": "æˆéƒ½è¡Œ"
            },
            {
                "type": "Railway",
                "date": "2020-09-01",
                "from": "æ—¥å–€åˆ™ç«™",
                "to": "æ‹‰è¨ç«™",
                "vehicle": "Z8804",
                "duration": "02:53:00",
                "distance": "248 km",
                "seat": "åŠ 1è½¦056",
                "price": 40.5,
                "note": "ç å³°è¿”ï¼Œè½¦é¥°ï¼Œè—æ°‘"
            },
            {
                "type": "Railway",
                "date": "2020-08-23",
                "from": "ä¸Šæµ·ç«™",
                "to": "æ‹‰è¨ç«™",
                "vehicle": "Z164",
                "duration": "47:27:00",
                "distance": "4373 km",
                "seat": "03è½¦011ä¸Šé“º",
                "price": 793.5,
                "note": "è¿›è—"
            },
            {
                "type": "Railway",
                "date": "2020-08-23",
                "from": "å®æ³¢ç«™",
                "to": "ä¸Šæµ·è™¹æ¡¥ç«™",
                "vehicle": "G7516",
                "duration": "01:54:00",
                "distance": "490 km",
                "seat": "10è½¦10C",
                "price": 144,
                "note": "ä¸Šæµ·ä¸­è½¬"
            },
            {
                "type": "Railway",
                "date": "2020-07-26",
                "from": "æ¡ä¹¡ç«™",
                "to": "å®æ³¢ç«™",
                "vehicle": "G7583",
                "duration": "01:14:00",
                "distance": "479 km",
                "seat": "08è½¦08D",
                "price": 92.5,
                "note": "ä¹Œé•‡è¡Œè¿”ç¨‹"
            },
            {
                "type": "Railway",
                "date": "2020-07-25",
                "from": "å®æ³¢ç«™",
                "to": "æ¡ä¹¡ç«™",
                "vehicle": "G7508",
                "duration": "01:20:00",
                "distance": "466 km",
                "seat": "07è½¦07C",
                "price": 92.5,
                "note": "ä¹Œé•‡è¡Œ"
            },
            {
                "type": "Railway",
                "date": "2020-01-15",
                "from": "åŒ—äº¬å—ç«™",
                "to": "å®æ³¢ç«™",
                "vehicle": "G167",
                "duration": "06:55:00",
                "distance": "1709 km",
                "seat": "06è½¦13F",
                "price": 446.5,
                "note": "19å†¬è¿”ä¹¡ï¼›é’å²›-å¾å·-æ­å·"
            },
            {
                "type": "Railway",
                "date": "2019-10-06",
                "from": "å¤©æ´¥ç«™",
                "to": "åŒ—äº¬å—ç«™",
                "vehicle": "C2036",
                "duration": "00:30:00",
                "distance": "120 km",
                "seat": "05è½¦13A",
                "price": 54.5,
                "note": "19äº¬æ´¥è¿”ç¨‹"
            },
            {
                "type": "Airline",
                "date": "2019-10-03",
                "from": "æ­å·è§å±±T1",
                "to": "åŒ—äº¬é¦–éƒ½T3",
                "vehicle": "CA1596",
                "duration": "01:49:00",
                "distance": "1200 km",
                "seat": "31A",
                "price": 410,
                "note": "è¿”æ ¡"
            },
            {
                "type": "Railway",
                "date": "2019-10-01",
                "from": "ä¸Šæµ·å—ç«™",
                "to": "æ­å·ä¸œç«™",
                "vehicle": "K79",
                "duration": "02:20:00",
                "distance": "2510 km",
                "seat": "14è½¦050",
                "price": 24.5,
                "note": "æ­å·è¡Œ"
            },
            {
                "type": "Railway",
                "date": "2019-09-27",
                "from": "åŒ—äº¬ç«™",
                "to": "ä¸Šæµ·ç«™",
                "vehicle": "D701",
                "duration": "12:04:00",
                "distance": "1463 km",
                "seat": "04è½¦010ä¸Šé“º",
                "price": 440,
                "note": "ä¸Šæµ·è¡Œ"
            },
            {
                "type": "Railway",
                "date": "2019-08-13",
                "from": "å¤§è¿åŒ—ç«™",
                "to": "åŒ—äº¬ç«™",
                "vehicle": "D43",
                "duration": "06:36:00",
                "distance": "774 km",
                "seat": "11è½¦01B",
                "price": 261,
                "note": "2019å®è·µå›¢è¿”ç¨‹"
            },
            {
                "type": "Other",
                "date": "2019-07-29",
                "from": "èˆ’å…°",
                "to": "å¤§è¿",
                "vehicle": "-",
                "duration": "",
                "distance": "nan km",
                "seat": "-",
                "price": "-",
                "note": "2019å®è·µå›¢"
            },
            {
                "type": "Railway",
                "date": "2019-07-22",
                "from": "å‰æ—ç«™",
                "to": "èˆ’å…°ç«™",
                "vehicle": 4341,
                "duration": "02:08:00",
                "distance": "131 km",
                "seat": "03è½¦016",
                "price": 6,
                "note": "èµ´èˆ’å…°"
            },
            {
                "type": "Railway",
                "date": "2019-07-22",
                "from": "é•¿æ˜¥ç«™",
                "to": "å‰æ—ç«™",
                "vehicle": "C1245",
                "duration": "00:40:00",
                "distance": "111 km",
                "seat": "04è½¦13B",
                "price": 31.5,
                "note": "å‰æ—ä¸­è½¬"
            },
            {
                "type": "Railway",
                "date": "2019-07-21",
                "from": "ç™½åŸç«™",
                "to": "é•¿æ˜¥ç«™",
                "vehicle": "C1302",
                "duration": "02:38:00",
                "distance": "420 km",
                "seat": "15è½¦14B",
                "price": 98,
                "note": "é•¿æ˜¥ä¸­è½¬"
            },
            {
                "type": "Other",
                "date": "2019-07-15",
                "from": "å‘¼ä¼¦è´å°”",
                "to": "ç™½åŸ",
                "vehicle": "-",
                "duration": "",
                "distance": "nan km",
                "seat": "-",
                "price": "-",
                "note": "2019å®è·µå›¢"
            },
            {
                "type": "Railway",
                "date": "2019-07-12",
                "from": "åŒ—äº¬ç«™",
                "to": "æµ·æ‹‰å°”ç«™",
                "vehicle": "K1303",
                "duration": "30:28:00",
                "distance": "2086 km",
                "seat": "05è½¦022ä¸­é“º",
                "price": 421,
                "note": "2019å®è·µå›¢å»ç¨‹"
            },
            {
                "type": "Railway",
                "date": "2019-06-30",
                "from": "æ­å·ä¸œç«™",
                "to": "åŒ—äº¬å—ç«™",
                "vehicle": "G32",
                "duration": "04:39:00",
                "distance": "1279 km",
                "seat": "04è½¦13F",
                "price": 404,
                "note": "19å¤è¿”æ ¡"
            },
            {
                "type": "Railway",
                "date": "2019-06-30",
                "from": "å®æ³¢ç«™",
                "to": "æ­å·ä¸œç«™",
                "vehicle": "G7540",
                "duration": "00:53:00",
                "distance": "610 km",
                "seat": "05è½¦06F",
                "price": 53.5,
                "note": "æ­å·ä¸­è½¬"
            },
            {
                "type": "Railway",
                "date": "2019-06-22",
                "from": "åŒ—äº¬å—ç«™",
                "to": "å®æ³¢ç«™",
                "vehicle": "G167",
                "duration": "06:55:00",
                "distance": "1709 km",
                "seat": "04è½¦04F",
                "price": 446.5,
                "note": "19å¤è¿”ä¹¡"
            },
            {
                "type": "Railway",
                "date": "2019-02-13",
                "from": "å®æ³¢ç«™",
                "to": "åŒ—äº¬å—ç«™",
                "vehicle": "G60",
                "duration": "06:51:00",
                "distance": "1434 km",
                "seat": "13è½¦11F",
                "price": 446.5,
                "note": "19æ˜¥è¿”æ ¡"
            },
            {
                "type": "Railway",
                "date": "2019-01-24",
                "from": "åŒ—äº¬å—ç«™",
                "to": "å®æ³¢ç«™",
                "vehicle": "G167",
                "duration": "06:55:00",
                "distance": "1709 km",
                "seat": "07è½¦10F",
                "price": 446.5,
                "note": "18å†¬è¿”ä¹¡"
            },
            {
                "type": "Railway",
                "date": "2018-10-02",
                "from": "å¤©æ´¥ç«™",
                "to": "åŒ—äº¬å—ç«™",
                "vehicle": "C2070",
                "duration": "00:35:00",
                "distance": "127 km",
                "seat": "07è½¦12C",
                "price": 54.5,
                "note": "18äº¬æ´¥è¿”ç¨‹"
            },
            {
                "type": "Railway",
                "date": "2018-08-29",
                "from": "å®æ³¢ç«™",
                "to": "åŒ—äº¬å—ç«™",
                "vehicle": "G56",
                "duration": "06:48:00",
                "distance": "2011 km",
                "seat": "13è½¦09F",
                "price": 446.5,
                "note": "18ç§‹å…¥å­¦"
            },
            {
                "type": "Railway",
                "date": "2017-08-27",
                "from": "åŒ—äº¬å—ç«™",
                "to": "å®æ³¢ç«™",
                "vehicle": "G167",
                "duration": "06:50:00",
                "distance": "1691 km",
                "seat": "12è½¦03D",
                "price": 595.5,
                "note": "æš‘æ ¡è¿”ç¨‹ï¼Œayiçš„åº§å·"
            },
            {
                "type": "Railway",
                "date": "2017-08-20",
                "from": "å®æ³¢ç«™",
                "to": "åŒ—äº¬å—ç«™",
                "vehicle": "G168",
                "duration": "07:30:00",
                "distance": "1709 km",
                "seat": "11è½¦12B",
                "price": 595.5,
                "note": "æš‘æ ¡"
            }
        ];

        // ========== æ ¸å¿ƒå¤„ç†é€»è¾‘ ==========
        // 1. æŒ‰è¡Œç¨‹åŒºé—´åˆ†ç»„å¹¶ç»Ÿè®¡é¢‘æ¬¡
        const routeGroups = {};
        const routeCounts = {};
        travelSegments.forEach(segment => {
            const key = `${segment.from}-${segment.to}`;
            if (!routeGroups[key]) routeGroups[key] = [];
            routeGroups[key].push(segment);
            routeCounts[key] = (routeCounts[key] || 0) + 1;
        });

        // 2. é¢œè‰²æ˜ å°„å‡½æ•°ï¼ˆæ ¹æ®é¢‘æ¬¡ï¼‰
        const getColorByCount = (count) => {
            return count > 2 ? '#ff0000' :  // é«˜é¢‘æ¬¡-çº¢è‰²
                count > 1 ? '#ff8000' :  // ä¸­é¢‘æ¬¡-æ©™è‰²
                    '#00aa00';   // ä½é¢‘æ¬¡-ç»¿è‰²
        };

        // 3. ç»˜åˆ¶è·¯çº¿ï¼ˆåˆå¹¶+çƒ­åŠ›æ•ˆæœï¼‰
        Object.entries(routeGroups).forEach(([key, trips]) => {
            const from = cityCoords[trips[0].from];
            const to = cityCoords[trips[0].to];
            const count = routeCounts[key];

            // åˆ›å»ºè·¯çº¿ï¼ˆçº¿å®½å’Œé¢œè‰²åæ˜ é¢‘æ¬¡ï¼‰
            const polyline = L.polyline([from, to], {
                color: getColorByCount(count),
                weight: 2 + count * 1.5,  // é¢‘æ¬¡è¶Šé«˜çº¿è¶Šç²—
                opacity: 0.7
            }).addTo(map);

            // å¼¹çª—å†…å®¹ï¼ˆåˆå¹¶æ˜¾ç¤ºæ‰€æœ‰è¡Œç¨‹ï¼‰
            const popupContent = `
        <div style="max-width:250px">
          <div style="display:flex;justify-content:space-between;align-items:center">
            <b>${trips[0].from} â†’ ${trips[0].to}</b>
            <span class="route-count">${count}æ¬¡</span>
          </div>
          <hr style="margin:5px 0">
          <div style="max-height:150px;overflow-y:auto">
            ${trips.map(trip => `
              <div style="margin-bottom:8px;padding-bottom:5px;border-bottom:1px dashed #eee">
                <div style="display:flex;justify-content:space-between">
                  <span>${trip.date}</span>
                  <span style="color:${getColorByCount(1)}">
                    ${trip.type === 'Rail' ? 'ğŸš„' : 'âœˆï¸'} ${trip.vehicle}
                  </span>
                </div>
                <div>ç”¨æ—¶: ${trip.duration}</div>
              </div>
            `).join('')}
          </div>
        </div>
      `;
            polyline.bindPopup(popupContent);
        });

        // ========== æ·»åŠ å›¾ä¾‹ ==========
        const legend = L.control({ position: 'bottomright' });
        legend.onAdd = () => {
            const div = L.DomUtil.create('div', 'legend');
            div.innerHTML = `
        <h4 style="margin:5px 0">è¡Œç¨‹é¢‘æ¬¡</h4>
        <div style="display:flex;align-items:center;margin:3px 0">
          <div style="background:#ff0000;width:15px;height:15px;margin-right:5px"></div>
          <span>é«˜é¢‘æ¬¡ (â‰¥3æ¬¡)</span>
        </div>
        <div style="display:flex;align-items:center;margin:3px 0">
          <div style="background:#ff8000;width:15px;height:15px;margin-right:5px"></div>
          <span>ä¸­é¢‘æ¬¡ (2æ¬¡)</span>
        </div>
        <div style="display:flex;align-items:center;margin:3px 0">
          <div style="background:#00aa00;width:15px;height:15px;margin-right:5px"></div>
          <span>ä½é¢‘æ¬¡ (1æ¬¡)</span>
        </div>
      `;
            return div;
        };
        legend.addTo(map);
    </script>
</body>

</html>